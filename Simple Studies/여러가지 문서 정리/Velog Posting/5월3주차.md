# 5월 3주차

## VIP(Virtual IP)란
- https://run-it.tistory.com/44

<br>

## `npm install`, `npx`시 TLS 1.2 이상 버전 사용 오류
- 아래 설정으로 해결 가능
```bash
$ npm config set registry https://registry.npmjs.org/
```
- 참고 : https://github.blog/2021-08-23-npm-registry-deprecating-tls-1-0-tls-1-1/

<br>

## husky + lint-staged로 깃 커밋시 lint 등 작업 수행하기
- 모노레포에서 구성시, 루트든 하위 패키지든 `lint`/`prettier`가 설치된 패키지에서 아래 명령어를 실행한다.
```bash
$ npx mrm@2 lint-staged
```
- `.husky/`가 생성되고 `husky`, `lint-staged` 생성 및 `package.json`에 lint-staged 설정이 생성된다. 
- 기본 생성된 `.husky/pre-commit`에서 `npx lint-staged`를 수행하는데 커밋시에 lint-staged를 실행하는 것이고, 이건 `package.json`에 `mrm@2`가 프로젝트 구조를 자동으로 인식해 알아서 적당히 eslint, prettier, stylelint 등을 수행하도록 설정한 내용을 실행한다.
- 나의 경우 `package.json`의 `lint-staged`를 아래와 같이 작성했다.
```json
{
  "lint-staged": {
    "**/*.!(config.){ts,tsx,js,jsx}": [
      "prettier --write",
      "eslint --fix"
    ]
  }
}
```
- `*.config.js`는 설정 파일로 린트 대상이 아녔기 때문에 린트 실행에서 제외하고 모든 js,jsx,ts,tsx 파일에 대해서 lint/prettier를 수행하고 자동으로 고칠 수 있는 내용을 고치도록 했다.
- 참고로 이걸 테스트한다고 최근 커밋에서 린트로 수정될 수 있는 내용만 추가해서 커밋하면 전체 린트 후 최근 커밋과 내용이 같기 때문에 [`빈 커밋`을 발생](https://github.com/okonet/lint-staged/issues/588)시킨다. 빈 커밋은 의미없는것으로 간주해 `lint-staged`는 종료되면서 린트했던 내용은 원복된다. 이게 싫으면 `lint-staged --allow-empty`해주면 되지만 안좋은 방법인 듯 하다.

<br>

## webpack, typescript의 module path alias
- https://jonghyun-park.medium.com/webpack-typescript%EC%97%90%EC%84%9C-path-alias-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0-ec32428622d2
- 모듈을 절대경로로 import 할 때 에디터에서 에러가 뜨는건 `tsconfig.json`, 빌드시 에러가 뜨면 `webpack.config.js`를 수정해줘야 한다. 
- `tsconfig`에서 `baseUrl: './'`로 설정하면 baseUrl의 디렉토리 src로 import하는게 가능하다. 이걸 webpack에서도 인식시키려면 path alias 설정을 해줘야한다.
```js
module.exports = {
  ...
  resolve: {
    alias: {
      src: path.resolve(__dirname, 'src'),
    },
  },
}
```
- 이렇게 설정하면 웹팩이 `src/~~`로 모듈 import하는 내용에 대해서 `./src`경로로 해석할 수 있게 된다.

